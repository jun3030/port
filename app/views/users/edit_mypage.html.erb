<div class="flex-container">


<div class="container">
<div class="comment">
  <div class="comment-left">
    <div class="user-image"><%= image_tag @user.image, :size => '150x150' %></div>
  </div>
  <div class="comment-right">
    <h1 class="user-name-mypage"><%= @user.name %><span class="user-info">(<%= @user.prefecture %>,<%= @user.age %><%= @user.sex %>)</span></h1>
    <ul class="test">
      <li>担当パート:<%= @user.responsible_part %></li>
      <li>好きなジャンル:<%= @user.genre %></li>
      <li>好きなアーティスト:<%= @user.favorite_artist %></li>
      <li class="self-introduction"><%= @user.self_introduction %></li>
    </ul>
  </div>
  <div class="instagram_search">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">
      <div class="from-instagram">from-instagram</div>
      </a>
      <ul class="dropdown-menu">
        <li>      
        <%= form_with(model: @user, url: upload_instagram_path, method: :patch, local: true) do |f| %>
        
          <%= f.label :token, class: "label-class" %>
          <%= f.text_field :first_token, class: "form-control" %>
          
          <%= f.label :app_id, class: "label-class" %>
          <%= f.number_field :app_id, class: "form-control" %>
          
          <%= f.label :app_secret, class: "label-class" %>
          <%= f.text_field :app_secret, class: "form-control" %>
          
          <%= f.label :media_count, class: "label-class" %>
          <%= f.number_field :media_count, class: "form-control" %>
          
          <%= f.submit "データを取得", class: "instagram-btn" %>
        <% end %>
        </li>
      </ul>
    </li>
    <div class="message">
      <%= link_to "メッセージ" %>
    </div>
    <div class="Footprint">
      <%= link_to "足跡" %>
    </div>
  </div>
</div>


</div>

<div class="container">
  <%= form_with(model: @user, url: user_users_url_path(current_user), method: :patch) do |f| %>
  <ul class="gallery" style="display:flex;flex-wrap:wrap;justify-content:flex-start;align-items: stretch;background: orange;">
    <% if @user.third_token.present? %>
    <% @instagram.each do |test| %> <!-- @instagram = @user.urls.where.not(users_url: nil) -->
      <%= f.fields_for "urls[]", test do |instagram| %>
        <li style="list-style:none;margin:20px;padding:0;">
          <!-- 現在ログイン中のユーザーが@userと同じなら全て表示--> 
          <% if current_user == @user %>
            <% if "mp4".in?(test.users_url) %>
              <%= link_to video_tag test.users_url, controls: true , :size => "281x281" %>
            <% else %>
              <%= image_tag test.users_url, :size => "281x281" %>
            <% end %>
              <div>
                <%= instagram.label "非公開" %>
                <%= instagram.check_box :public_url, {} , "true", "false" %>
              </div>
          <!-- public_urlがtrueのコンテンツは表示しない -->
          <% elsif test.public_url == true %>
          <!-- public_urlがfalseのコンテンツは表示 -->
          <% elsif test.public_url == false %>
              <% if "mp4".in?(test.users_url) %>
                <%= link_to video_tag test.users_url, controls: true , :size => "281x281" %>
              <% else %>
                <%= image_tag test.users_url, :size => "281x281" %>
              <% end %>
              <div>
                
              </div>
          <% end %>
        </li>
      <% end %>
    <% end %>
    <% end %>
  </ul>
  <%= f.submit "公開情報を変更" %>
  <% end %>
</div>


</div>
