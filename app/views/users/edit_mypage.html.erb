<div class="container">
<div class="comment">
  <div class="comment-left">
    <div class="user-image"><%= image_tag @user.image, :size => '150x150' %></div>
  </div>
  <div class="comment-right">
    <h1 class="user-name-mypage"><%= @user.name %><span class="user-info">(<%= @user.prefecture %>,<%= @user.age %><%= @user.sex %>)</span></h1>
    <ul class="test">
      <li>担当パート:<%= @user.responsible_part %></li>
      <li>好きなジャンル:<%= @user.genre %></li>
      <li>好きなアーティスト:<%= @user.favorite_artist %></li>
      <li class="self-introduction"><%= @user.self_introduction %></li>
    </ul>
  </div>
  <div class="instagram_search">
    <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">
      <div class="from-instagram">from-instagram</div>
      </a>
      <ul class="dropdown-menu">
        <li>      
        <!-- マイページにinstagramの写真、動画を追加する -->
        <%= form_with(model: @user, url: upload_instagram_path, method: :patch, local: true) do |f| %>
        
          <%= f.label :token, class: "label-class" %>
          <%= f.text_field :first_token, class: "form-control" %>
          
          <%= f.label :app_id, class: "label-class" %>
          <%= f.number_field :app_id, class: "form-control" %>
          
          <%= f.label :app_secret, class: "label-class" %>
          <%= f.text_field :app_secret, class: "form-control" %>
          
          <%= f.label :media_count, class: "label-class" %>
          <%= f.number_field :media_count, class: "form-control" %>
          
          <%= f.submit "データを取得", class: "instagram-btn" %>
        <% end %>
        </li>
      </ul>
    </li>
    <div class="add-content">
      <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown">
      <div class="from-instagram">コンテンツを追加</div>
      </a>
      <ul class="dropdown-menu">
        <li>      
        <h2>※画像か動画、どちらか1つを選択し投稿してください。</h2>
        <!-- マイページに写真、動画を追加する -->
          <%= form_with(model: @url, url: user_add_mypage_content_create_path(@test_id), local: true) do |f| %>
              
              <%= f.label :mypage_image %><br>
              <%= f.file_field :mypage_image %><br>
              
              <%= f.label :mypage_movie %><br>
              <%= f.file_field :mypage_movie %><br>
              
              <%= f.submit "投稿する" %>
          <% end %> 
        
        </li>
      </ul>
    </li>
    </div>
    <div class="message">
      <%= link_to "メッセージ" %>
    </div>
    <div class="Footprint">
      <%= link_to "足跡" %>
    </div>
  </div>
</div>
</div>


<div class="container">
  <%= form_with(model: @user, url: user_users_url_path(current_user), method: :patch) do |f| %>
  <ul class="gallery">
  <% if @user.third_token.present? %>
    <% @instagram.each do |test| %> <!-- @instagram = @user.urls.all -->
      <%= f.fields_for "urls[]", test do |instagram| %>
        <li class="aaa">  
          <!-- 現在ログイン中のユーザーが@userと同じなら全て表示--> 
        <% if current_user == @user %>
          <!-- test.users_urlはusers_urlがnilも表記されてしまう(viewには見えないが存在している)　その為users_urlに値が入っているもののみに if test.users_url.include?("mp4") を適用している -->
          <% if !test.users_url.nil? %> 
            <% if test.users_url.include?("mp4") %>
                <div class="tee">
                  <%= video_tag test.users_url, controls: true , :size => "281x281" %>
                </div>
            <% else %>
                <div class="tee">
                  <%= image_tag test.users_url, :size => "281x281" %>
                </div>
            <% end %>
          <% else %>
                <div class="tee">
                  <% if test.mypage_image %>
                    <%= image_tag test.mypage_image, :size => "281x281" %>
                  <% else %>
                    <%= video_tag test.mypage_movie, controls: true , :size => "281x281" %>
                  <% end %>
                </div>
          <% end %>
              <div class="tee-test">
                <%= link_to ":記事として投稿", user_posts_path(current_user, date: test.users_url) %>
                <%= instagram.label ":非公開" %>
                <%= instagram.check_box :public_url, {} , "true", "false" %>
              </div class="tee-test">
          <!-- public_urlがtrueのコンテンツは表示しない -->
        <% elsif test.public_url == true %>
             
          <!-- public_urlがfalseのコンテンツは表示 -->
        <% elsif test.public_url == false %>
            
            
          
            <h1>aa</h1>
            
            
            
         <% end %>
        </li>
      <% end %>
    <% end %> <!-- @instagram.each do |test| -->
    <% end %> <!-- if @user.third_token.present? -->
  </ul>
  <% if current_user == @user %>
 　　 <%= f.submit "公開情報を変更" %>
  <% end %>
  <% end %>　
</div>



